<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${emission.id == null} ? 'Neuen Datensatz hinzufügen' : 'Datensatz bearbeiten'"></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        :root { --primary-color: #2e7d32; --secondary-color: #006064; --bg-light: #f4f7f6; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-light); padding-top: 50px; }
        .card { border-radius: 15px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .card-header { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; border-radius: 15px 15px 0 0 !important; padding: 20px; }
        .btn-primary { background-color: var(--primary-color); border: none; }
        .form-label { font-weight: 600; color: #444; }
    </style>
</head>
<body>
<div class="container" style="max-width: 700px;">
    <div class="card shadow">
        <div class="card-header text-center">
            <h3 class="mb-0">
                <i th:class="${emission.id == null} ? 'bi bi-plus-circle me-2' : 'bi bi-pencil-square me-2'"></i>
                <span th:text="${emission.id == null} ? 'Neuen Datensatz hinzufügen' : 'Datensatz bearbeiten'"></span>
            </h3>
        </div>
        <div class="card-body p-4">
            <form th:action="@{/speichern}" th:object="${emission}" method="post">
                <input type="hidden" th:field="*{id}">

                <div class="row">
                    <div class="col-12 mb-3">
                        <label class="form-label">Datenstand (Jahr)</label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-calendar-event"></i></span>
                            <input type="number" 
                                   id="year"
                                   name="year"
                                   th:value="${emission.year == 0 ? '' : emission.year}" 
                                   class="form-control" 
                                   placeholder="YYYY" 
                                   min="1990" 
                                   max="2100" 
                                   required>
                        </div>
                    </div>

                    <div class="col-12 mb-3">
                        <label class="form-label">Land / Region</label>
                        <input type="text" th:field="*{land}" class="form-control" placeholder="z.B. Germany" required>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label class="form-label">CO2 Gesamt (Mio. t)</label>
                        <div class="input-group">
                            <input type="number" step="0.01" 
                                   id="wert"
                                   name="wert"
                                   th:value="${emission.wert == 0.0 ? '' : emission.wert}"
                                   class="form-control" placeholder="z.B. 10.5" min="0" required>
                            <span class="input-group-text">Mt</span>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Pro Kopf (t)</label>
                        <div class="input-group">
                            <input type="number" step="0.01" 
                                   id="perCapita"
                                   name="perCapita"
                                   th:value="${emission.perCapita == 0.0 ? '' : emission.perCapita}"
                                   class="form-control" placeholder="z.B. 8.2" min="0" required>
                            <span class="input-group-text">t/P.</span>
                        </div>
                    </div>
                    
                    <div class="col-12 mb-3">
                        <label class="form-label">Trend / Wachstum (%)</label>
                        <div class="input-group">
                            <input type="number" step="0.01" 
                                   id="growthPrct"
                                   name="growthPrct"
                                   th:value="${emission.growthPrct == 0.0 ? '' : emission.growthPrct}"
                                   class="form-control" placeholder="z.B. -2.5">
                            <span class="input-group-text">%</span>
                        </div>
                    </div>

                    <div class="col-12 mt-4">
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg shadow-sm">Speichern</button>
                            <a href="/backend" class="btn btn-outline-secondary">Abbrechen</a>
                        </div>
                    </div>
                </div> 
            </form>
        </div> 
        
        <div sec:authorize="hasRole('SCIENTIST')" class="text-center pb-4 text-muted small">
            <i class="bi bi-info-circle me-1"></i> Änderungen müssen nach dem Speichern noch freigegeben werden.
        </div>
    </div> 
</div> 
</body>
</html>